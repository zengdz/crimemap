<!DOCTYPE html>
<html>

  <head>
  	<title>我和城市的故事</title>
  	<meta charset="utf-8">
    <style type="text/css">
      html, body { height: 100%; margin: 0; padding: 0; }
      #map { height: 100%; width: 70% }
    </style>
  </head>

  <body>
  	<h1>我与广州的故事</h1>
  	<p>城市里留下了我的哪些足迹...</p>
    <!--此处的div是为了容纳JavaScript的组件，通过getElementById('map')来匹配-->
    <div id="map"></div>

    <div id="recordform">
		<h2>记录新鲜事</h2>
		<form action="/submitrecord" method="POST">
			<label for="category">Category</label>
			<select name="category" id="category">
				<option value="eating">吃喝</option>
				<option value="playing">游玩</option>
			</select>
			<label for="date">Date</label>
				<input name="日期" id="date" type="date">
			<label for="latitude">Latitude</label>
				<input name="latitude" id="latitude" type="text">
			<label for="longitude">Longitude</label>
				<input name="longitude" id="longitude" type="text">
			<label for="description">Description</label>
				<textarea name="description" id="description" placeholder="干什么去了..."></textarea>
			<input type="submit" value="Submit">
		</form>
	</div>

    <script type="text/javascript">
		var map; //把变量map放在函数外部，用作全局变量
		var marker;
		function initMap() {
			//把地图中心定在广州市并放大适当倍数
			var mapOptions = {center: {lat: 23.117055306224895, lng: 113.2759952545166}, zoom: 13}
			map = new google.maps.Map(document.getElementById('map'), mapOptions);
			//添加一个对鼠标单击的监听事件，构建匿名函数参数是该事件，随后触发函数placeMarker
			//函数placeMarker的参数是点击事件的经纬度
			google.maps.event.addListener(map, 'click', function(event){placeMarker(event.latLng);});
		}

		function placeMarker(location) {
			//如果标记已经存在，那么不创建新的标记，而是把已经存在的标记的位置移到新的位置
			if (marker){
				marker.setPosition(location);
			}
			//如果没有标记存在，则在点击处创建新的标记
			else {
				marker = new google.maps.Marker({position: location, map: map});
			}
		}
    </script>

    <!-- script标记中包含的URL是一个JavaScript文件的位置，该文件用于加载 Google Maps API 所需的所有符号和定义。此 script 标记为必填项-->
    <!-- Web 安全性相当重要，尽可能使用 HTTPS。使用上文提供的 <script> 标记通过 HTTPS 加载 Google Maps JavaScript API-->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjsoSHWM0pzxvZzlWZ9XuO2pUoDKs3oCU&callback=initMap"></script>
    <!--async 属性允许浏览器在 Maps API 加载的同时渲染网站的其余内容。当 API 就绪时，它将调用使用 callback 参数指定的函数。-->

  </body>

</html>

